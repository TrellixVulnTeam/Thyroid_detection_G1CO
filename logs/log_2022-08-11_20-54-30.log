[2022-08-11 20:54:32,360] root - INFO - Training pipeline config: TrainingPipelineConfig(artifactdir='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact')
[2022-08-11 20:54:32,360] root - INFO - Data ingestion Config: DataIngestionConfig(dataset_download_url='https://github.com/shubhamkambleX/Data-Science-Material/raw/main/Thyroid_Dataset.tgz', tgz_download_dir='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_ingestion\\2022-08-11-20-54-30\\tgz_data', raw_data_dir='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_ingestion\\2022-08-11-20-54-30\\raw_data', ingested_train_dir='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_ingestion\\2022-08-11-20-54-30\\ingested_data\\train', ingested_test_dir='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_ingestion\\2022-08-11-20-54-30\\ingested_data\\test')
[2022-08-11 20:54:32,360] root - INFO - ********************Data Ingestion log Started. ******************** 
[2022-08-11 20:54:32,368] root - INFO - Downloading file from :[https://github.com/shubhamkambleX/Data-Science-Material/raw/main/Thyroid_Dataset.tgz] into :[D:\Shubham\Ineuron Session\ML Projects\Machine_Leraning_Project_1\housing\artifact\data_ingestion\2022-08-11-20-54-30\tgz_data\Thyroid_Dataset.tgz]
[2022-08-11 20:54:33,451] root - INFO - File :[D:\Shubham\Ineuron Session\ML Projects\Machine_Leraning_Project_1\housing\artifact\data_ingestion\2022-08-11-20-54-30\tgz_data\Thyroid_Dataset.tgz] has been downloaded successfully.
[2022-08-11 20:54:33,451] root - INFO - Extracting the tgz files: [D:\Shubham\Ineuron Session\ML Projects\Machine_Leraning_Project_1\housing\artifact\data_ingestion\2022-08-11-20-54-30\tgz_data\Thyroid_Dataset.tgz] into dir [D:\Shubham\Ineuron Session\ML Projects\Machine_Leraning_Project_1\housing\artifact\data_ingestion\2022-08-11-20-54-30\raw_data]
[2022-08-11 20:54:33,466] root - INFO - Extraction completd
[2022-08-11 20:54:33,466] root - INFO - Reading the CSV file: [D:\Shubham\Ineuron Session\ML Projects\Machine_Leraning_Project_1\housing\artifact\data_ingestion\2022-08-11-20-54-30\raw_data\Thyroid_Dataset.csv]
[2022-08-11 20:54:33,497] root - INFO - Exporting the training dataset to file: [D:\Shubham\Ineuron Session\ML Projects\Machine_Leraning_Project_1\housing\artifact\data_ingestion\2022-08-11-20-54-30\ingested_data\train\Thyroid_Dataset.csv] 
[2022-08-11 20:54:33,535] root - INFO - Exporting the test dataset to file : [D:\Shubham\Ineuron Session\ML Projects\Machine_Leraning_Project_1\housing\artifact\data_ingestion\2022-08-11-20-54-30\ingested_data\test\Thyroid_Dataset.csv] 
[2022-08-11 20:54:33,552] root - INFO - Data Ingestion Artifact: [DataIngestionArtifact(train_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_ingestion\\2022-08-11-20-54-30\\ingested_data\\train\\Thyroid_Dataset.csv', test_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_ingestion\\2022-08-11-20-54-30\\ingested_data\\test\\Thyroid_Dataset.csv', is_ingested=True, message='Data Ingestion Successfully Completed.')]
[2022-08-11 20:54:33,552] root - INFO - ==================== Data Ingestion Log Completed. ==================== 
 

[2022-08-11 20:54:33,552] root - INFO - Data Validation Config: DataValidationConfig(schema_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\config\\schema.yaml', report_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_validation\\2022-08-11-20-54-30\\report.json', report_page_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_validation\\2022-08-11-20-54-30\\report.html')
[2022-08-11 20:54:33,552] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Data Valdaition log started.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 


[2022-08-11 20:54:33,552] root - INFO - Checking if training and test file is available
[2022-08-11 20:54:33,552] root - INFO - Is train and test file exists?-> True
[2022-08-11 20:54:34,780] root - INFO - Data validation artifact: DataValidationArtifact(schema_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\config\\schema.yaml', report_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_validation\\2022-08-11-20-54-30\\report.json', report_page_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_validation\\2022-08-11-20-54-30\\report.html', is_validated=True, message='Data Validation performed successully.')
[2022-08-11 20:54:34,780] root - INFO - Data transformation config: DataTransformationConfig(add_bedroom_per_room=True, transformed_train_dir='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_transformation\\2022-08-11-20-54-30\\transformed_data\\train', transformed_test_dir='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_transformation\\2022-08-11-20-54-30\\transformed_data\\test', preprocessed_object_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_transformation\\2022-08-11-20-54-30\\preprocessed\\preprocessed.pkl')
[2022-08-11 20:54:34,780] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Data Transformation log started.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
[2022-08-11 20:54:34,780] root - INFO - Obtaining preprocessing object.
[2022-08-11 20:54:34,795] root - INFO - Categorical columns: ['sex', 'on_thyroxine', 'on_antithyroid_medication', 'sick', 'pregnant', 'thyroid_surgery', 'I131_treatment', 'query_hypothyroid', 'query_hyperthyroid', 'lithium', 'goitre', 'tumor', 'hypopituitary', 'psych', 'referral_source']
[2022-08-11 20:54:34,795] root - INFO - Numerical columns: ['age', 'TSH', 'T3', 'TT4', 'T4U', 'FTI']
[2022-08-11 20:54:34,795] root - INFO - Obtaining training and test file path.
[2022-08-11 20:54:34,795] root - INFO - Loading training and test data as pandas dataframe.
[2022-08-11 20:54:34,884] root - INFO - Splitting input and target feature from training and testing dataframe.
[2022-08-11 20:54:34,884] root - INFO - Applying preprocessing object on training dataframe and testing dataframe
[2022-08-11 20:54:34,969] root - INFO - Saving transformed training and testing array.
[2022-08-11 20:54:34,970] root - INFO - Saving preprocessing object.
[2022-08-11 20:54:34,970] root - INFO - Data transformationa artifact: DataTransformationArtifact(is_transformed=True, message='Data transformation successfull.', transformed_train_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_transformation\\2022-08-11-20-54-30\\transformed_data\\train\\Thyroid_Dataset.npz', transformed_test_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_transformation\\2022-08-11-20-54-30\\transformed_data\\test\\Thyroid_Dataset.npz', preprocessed_object_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\data_transformation\\2022-08-11-20-54-30\\preprocessed\\preprocessed.pkl')
[2022-08-11 20:54:34,970] root - INFO - Model trainer config: ModelTrainerConfig(trained_model_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\model_trainer\\2022-08-11-20-54-30\\trained_model\\model.pkl', base_accuracy=0.6, model_config_file_path='config\\model.yaml')
[2022-08-11 20:54:34,970] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Model trainer log started.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
[2022-08-11 20:54:34,970] root - INFO - Loading transformed training dataset
[2022-08-11 20:54:34,985] root - INFO - Loading transformed testing dataset
[2022-08-11 20:54:34,993] root - INFO - Splitting training and testing input and target feature
[2022-08-11 20:54:34,993] root - INFO - Extracting model config file path
[2022-08-11 20:54:34,993] root - INFO - Initializing model factory class using above model config file: config\model.yaml
[2022-08-11 20:54:34,993] root - INFO - Expected accuracy: 0.6
[2022-08-11 20:54:34,993] root - INFO - Initiating operation model selecttion
[2022-08-11 20:54:34,993] root - INFO - Started Initializing model from config file
[2022-08-11 20:54:34,993] root - INFO - Executing command: from <module 'sklearn.linear_model' from 'D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\venv\\lib\\site-packages\\sklearn\\linear_model\\__init__.py'> import LogisticRegression
[2022-08-11 20:54:35,029] root - INFO - Executing:$ LogisticRegression().fit_intercept=True
[2022-08-11 20:54:49,683] root - INFO - Executing command: from <module 'sklearn.ensemble' from 'D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\venv\\lib\\site-packages\\sklearn\\ensemble\\__init__.py'> import RandomForestClassifier
[2022-08-11 20:54:49,685] root - INFO - Executing:$ RandomForestClassifier().min_samples_leaf=3
[2022-08-11 20:54:49,687] root - INFO - Initialized model: [InitializedModelDetail(model_serial_number='module_0', model=LogisticRegression(), param_grid_search={'fit_intercept': [True, False]}, model_name='sklearn.linear_model.LogisticRegression'), InitializedModelDetail(model_serial_number='module_1', model=RandomForestClassifier(min_samples_leaf=3), param_grid_search={'min_samples_leaf': [6]}, model_name='sklearn.ensemble.RandomForestClassifier')]
[2022-08-11 20:54:49,687] root - INFO - Executing command: from <module 'sklearn.model_selection' from 'D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\venv\\lib\\site-packages\\sklearn\\model_selection\\__init__.py'> import GridSearchCV
[2022-08-11 20:54:49,689] root - INFO - Executing:$ GridSearchCV(estimator=LogisticRegression(),
             param_grid={'fit_intercept': [True, False]}).cv=5
[2022-08-11 20:54:49,690] root - INFO - Executing:$ GridSearchCV(cv=5, estimator=LogisticRegression(),
             param_grid={'fit_intercept': [True, False]}).verbose=2
[2022-08-11 20:54:49,690] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> f"Training LogisticRegression Started." <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[2022-08-11 20:54:51,240] root - INFO - Executing command: from <module 'sklearn.model_selection' from 'D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\venv\\lib\\site-packages\\sklearn\\model_selection\\__init__.py'> import GridSearchCV
[2022-08-11 20:54:51,249] root - INFO - Executing:$ GridSearchCV(estimator=RandomForestClassifier(min_samples_leaf=3),
             param_grid={'min_samples_leaf': [6]}).cv=5
[2022-08-11 20:54:51,249] root - INFO - Executing:$ GridSearchCV(cv=5, estimator=RandomForestClassifier(min_samples_leaf=3),
             param_grid={'min_samples_leaf': [6]}).verbose=2
[2022-08-11 20:54:51,249] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> f"Training RandomForestClassifier Started." <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[2022-08-11 20:54:52,843] root - INFO - Acceptable model found:GridSearchedBestModel(model_serial_number='module_0', model=LogisticRegression(), best_model=LogisticRegression(fit_intercept=False), best_parameters={'fit_intercept': False}, best_score=0.9608859675134263)
[2022-08-11 20:54:52,844] root - INFO - Acceptable model found:GridSearchedBestModel(model_serial_number='module_1', model=RandomForestClassifier(min_samples_leaf=3), best_model=RandomForestClassifier(min_samples_leaf=6), best_parameters={'min_samples_leaf': 6}, best_score=0.9907191415988491)
[2022-08-11 20:54:52,845] root - INFO - Best model: GridSearchedBestModel(model_serial_number='module_1', model=RandomForestClassifier(min_samples_leaf=3), best_model=RandomForestClassifier(min_samples_leaf=6), best_parameters={'min_samples_leaf': 6}, best_score=0.9907191415988491)
[2022-08-11 20:54:52,845] root - INFO - Best model found on training dataset: GridSearchedBestModel(model_serial_number='module_1', model=RandomForestClassifier(min_samples_leaf=3), best_model=RandomForestClassifier(min_samples_leaf=6), best_parameters={'min_samples_leaf': 6}, best_score=0.9907191415988491)
[2022-08-11 20:54:52,847] root - INFO - Extracting trained model list.
[2022-08-11 20:54:52,847] root - INFO - Evaluation all trained model on training and testing dataset both
[2022-08-11 20:54:52,847] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Started evaluating model: [LogisticRegression] <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[2022-08-11 20:54:52,862] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Score <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[2022-08-11 20:54:52,863] root - INFO - Train Score		 Test Score		 Average Score
[2022-08-11 20:54:52,863] root - INFO - 0.6794520547945204		 0.7578947368421053		0.7165329052969501
[2022-08-11 20:54:52,863] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Loss <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[2022-08-11 20:54:52,863] root - INFO - Diff test train accuracy: [0.07844268204758487].
[2022-08-11 20:54:52,863] root - INFO - Train log loss error: [1.33942434039907].
[2022-08-11 20:54:52,863] root - INFO - Test log loss error: [1.0521757042124193].
[2022-08-11 20:54:52,864] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Started evaluating model: [RandomForestClassifier] <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[2022-08-11 20:54:52,938] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Score <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[2022-08-11 20:54:52,938] root - INFO - Train Score		 Test Score		 Average Score
[2022-08-11 20:54:52,938] root - INFO - 0.9665271966527197		 1.0		0.9829787234042554
[2022-08-11 20:54:52,938] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Loss <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
[2022-08-11 20:54:52,938] root - INFO - Diff test train accuracy: [0.03347280334728031].
[2022-08-11 20:54:52,938] root - INFO - Train log loss error: [0.18317256104825874].
[2022-08-11 20:54:52,938] root - INFO - Test log loss error: [9.992007221626413e-16].
[2022-08-11 20:54:52,938] root - INFO - Acceptable model found MetricInfoArtifact(model_name='RandomForestClassifier(min_samples_leaf=6)', model_object=RandomForestClassifier(min_samples_leaf=6), train_log_loss=0.18317256104825874, test_log_loss=9.992007221626413e-16, train_accuracy=0.9665271966527197, test_accuracy=1.0, model_accuracy=0.9829787234042554, index_number=1). 
[2022-08-11 20:54:52,938] root - INFO - Best found model on both training and testing dataset.
[2022-08-11 20:54:52,938] root - INFO - Saving model at path: D:\Shubham\Ineuron Session\ML Projects\Machine_Leraning_Project_1\housing\artifact\model_trainer\2022-08-11-20-54-30\trained_model\model.pkl
[2022-08-11 20:54:52,995] root - INFO - Model Trainer Artifact: ModelTrainerArtifact(is_trained=True, message='Model Trained successfully', trained_model_file_path='D:\\Shubham\\Ineuron Session\\ML Projects\\Machine_Leraning_Project_1\\housing\\artifact\\model_trainer\\2022-08-11-20-54-30\\trained_model\\model.pkl', train_log_loss=0.18317256104825874, test_log_loss=9.992007221626413e-16, train_accuracy=0.9665271966527197, test_accuracy=1.0, model_accuracy=0.9829787234042554)
[2022-08-11 20:54:52,995] root - INFO - >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Model trainer log completed.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
